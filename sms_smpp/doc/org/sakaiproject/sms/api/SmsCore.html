<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_11) on Wed Nov 19 10:05:18 CAT 2008 -->
<TITLE>
SmsCore
</TITLE>

<META NAME="keywords" CONTENT="org.sakaiproject.sms.api.SmsCore interface">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="SmsCore";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/SmsCore.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../org/sakaiproject/sms/api/SmsBilling.html" title="interface in org.sakaiproject.sms.api"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../org/sakaiproject/sms/api/SmsDataLogic.html" title="interface in org.sakaiproject.sms.api"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?org/sakaiproject/sms/api/SmsCore.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SmsCore.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.sakaiproject.sms.api</FONT>
<BR>
Interface SmsCore</H2>
<HR>
<DL>
<DT><PRE>public interface <B>SmsCore</B></DL>
</PRE>

<P>
The SMS service will handle all logic regarding the queueing, sending and
 receiving of messages.
<P>

<P>
<DL>
<DT><B>Version:</B></DT>
  <DD>1.0</DD>
<DT><B>Author:</B></DT>
  <DD>louis@psybergate.com</DD>
</DL>
<HR>

<P>

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../org/sakaiproject/sms/model/SmsMessage.html" title="class in org.sakaiproject.sms.model">SmsMessage</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/sakaiproject/sms/api/SmsCore.html#getDeliveryGroup(java.lang.String, java.lang.String)">getDeliveryGroup</A></B>(java.lang.String&nbsp;sakaiSiteID,
                 java.lang.String&nbsp;sakaiGroupID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the group list from Sakai and remove users with invalid/empty mobile
 numbers or opted out profiles.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../org/sakaiproject/sms/model/SmsDeliveryReport.html" title="class in org.sakaiproject.sms.model">SmsDeliveryReport</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/sakaiproject/sms/api/SmsCore.html#getDeliveryReports()">getDeliveryReports</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get all buffered gateway delivery reports from SMPP service.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../org/sakaiproject/sms/model/SmsTask.html" title="class in org.sakaiproject.sms.model">SmsTask</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/sakaiproject/sms/api/SmsCore.html#getNextSmsTask()">getNextSmsTask</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Find the next sms task to process from the task queue.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/sakaiproject/sms/api/SmsCore.html#getSakaiMobileNumber(java.lang.String)">getSakaiMobileNumber</A></B>(java.lang.String&nbsp;sakaiUserID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get Sakai user's mobile number from profile.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/sakaiproject/sms/api/SmsCore.html#insertIntoDebugLog()">insertIntoDebugLog</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Make entry into log file.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/sakaiproject/sms/api/SmsCore.html#insertNewTask(org.sakaiproject.sms.model.SmsTask)">insertNewTask</A></B>(<A HREF="../../../../org/sakaiproject/sms/model/SmsTask.html" title="class in org.sakaiproject.sms.model">SmsTask</A>&nbsp;smsTask)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add a new task to the sms task list, for eg.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/sakaiproject/sms/api/SmsCore.html#processIncomingMessage(org.sakaiproject.sms.model.SmsMessage)">processIncomingMessage</A></B>(<A HREF="../../../../org/sakaiproject/sms/model/SmsMessage.html" title="class in org.sakaiproject.sms.model">SmsMessage</A>&nbsp;smsMessage)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Try to process an incoming message in real-time by inserting it into the
 queue and calling processMessage immediately.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/sakaiproject/sms/api/SmsCore.html#processTask(org.sakaiproject.sms.model.SmsTask)">processTask</A></B>(<A HREF="../../../../org/sakaiproject/sms/model/SmsTask.html" title="class in org.sakaiproject.sms.model">SmsTask</A>&nbsp;smsTask)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the list of users that must receive the message.</TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="getDeliveryGroup(java.lang.String, java.lang.String)"><!-- --></A><H3>
getDeliveryGroup</H3>
<PRE>
<A HREF="../../../../org/sakaiproject/sms/model/SmsMessage.html" title="class in org.sakaiproject.sms.model">SmsMessage</A>[] <B>getDeliveryGroup</B>(java.lang.String&nbsp;sakaiSiteID,
                              java.lang.String&nbsp;sakaiGroupID)</PRE>
<DL>
<DD>Get the group list from Sakai and remove users with invalid/empty mobile
 numbers or opted out profiles.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>sakaiSiteID</CODE> - <DD><CODE>sakaiGroupID</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="getNextSmsTask()"><!-- --></A><H3>
getNextSmsTask</H3>
<PRE>
<A HREF="../../../../org/sakaiproject/sms/model/SmsTask.html" title="class in org.sakaiproject.sms.model">SmsTask</A> <B>getNextSmsTask</B>()</PRE>
<DL>
<DD>Find the next sms task to process from the task queue. Determine tasks
 with highest priority. Priority is based on message age and type.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getSakaiMobileNumber(java.lang.String)"><!-- --></A><H3>
getSakaiMobileNumber</H3>
<PRE>
java.lang.String <B>getSakaiMobileNumber</B>(java.lang.String&nbsp;sakaiUserID)</PRE>
<DL>
<DD>Get Sakai user's mobile number from profile. Return the mobile number,
 null if no found. String to cater for international syntax (+27)
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>sakaiUserID</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="insertIntoDebugLog()"><!-- --></A><H3>
insertIntoDebugLog</H3>
<PRE>
void <B>insertIntoDebugLog</B>()</PRE>
<DL>
<DD>Make entry into log file.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="insertNewTask(org.sakaiproject.sms.model.SmsTask)"><!-- --></A><H3>
insertNewTask</H3>
<PRE>
void <B>insertNewTask</B>(<A HREF="../../../../org/sakaiproject/sms/model/SmsTask.html" title="class in org.sakaiproject.sms.model">SmsTask</A>&nbsp;smsTask)</PRE>
<DL>
<DD>Add a new task to the sms task list, for eg. send message to all
 administrators at 10:00, or get latest announcements and send to mobile
 numbers of Sakai group x.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="processTask(org.sakaiproject.sms.model.SmsTask)"><!-- --></A><H3>
processTask</H3>
<PRE>
void <B>processTask</B>(<A HREF="../../../../org/sakaiproject/sms/model/SmsTask.html" title="class in org.sakaiproject.sms.model">SmsTask</A>&nbsp;smsTask)</PRE>
<DL>
<DD>Get the list of users that must receive the message. Send messages to
 SMPP service and also add them to SMS_MESSAGE table as pending. (Statuses
 will be updated when the gateway delivery notifications comes in)
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getDeliveryReports()"><!-- --></A><H3>
getDeliveryReports</H3>
<PRE>
<A HREF="../../../../org/sakaiproject/sms/model/SmsDeliveryReport.html" title="class in org.sakaiproject.sms.model">SmsDeliveryReport</A>[] <B>getDeliveryReports</B>()</PRE>
<DL>
<DD>Get all buffered gateway delivery reports from SMPP service. And update
 status in SMS_MESSAGE table according to notification code.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="processIncomingMessage(org.sakaiproject.sms.model.SmsMessage)"><!-- --></A><H3>
processIncomingMessage</H3>
<PRE>
void <B>processIncomingMessage</B>(<A HREF="../../../../org/sakaiproject/sms/model/SmsMessage.html" title="class in org.sakaiproject.sms.model">SmsMessage</A>&nbsp;smsMessage)</PRE>
<DL>
<DD>Try to process an incoming message in real-time by inserting it into the
 queue and calling processMessage immediately. If unable to process, then
 leave in the queue for the job scheduler to handle. Incoming messages are
 for later.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>messageID</CODE> - </DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/SmsCore.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../org/sakaiproject/sms/api/SmsBilling.html" title="interface in org.sakaiproject.sms.api"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../org/sakaiproject/sms/api/SmsDataLogic.html" title="interface in org.sakaiproject.sms.api"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?org/sakaiproject/sms/api/SmsCore.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SmsCore.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
