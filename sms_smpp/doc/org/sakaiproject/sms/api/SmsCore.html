<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_11) on Thu Dec 18 13:17:16 CAT 2008 -->
<TITLE>
SmsCore
</TITLE>

<META NAME="keywords" CONTENT="org.sakaiproject.sms.api.SmsCore interface">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="SmsCore";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/SmsCore.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../org/sakaiproject/sms/api/SmsBilling.html" title="interface in org.sakaiproject.sms.api"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../org/sakaiproject/sms/api/SmsScheduler.html" title="interface in org.sakaiproject.sms.api"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?org/sakaiproject/sms/api/SmsCore.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SmsCore.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.sakaiproject.sms.api</FONT>
<BR>
Interface SmsCore</H2>
<DL>
<DT><B>All Known Implementing Classes:</B> <DD><A HREF="../../../../org/sakaiproject/sms/impl/SmsCoreImpl.html" title="class in org.sakaiproject.sms.impl">SmsCoreImpl</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public interface <B>SmsCore</B></DL>
</PRE>

<P>
The SMS service will handle all logic regarding the queueing, sending and
 receiving of messages.
<P>

<P>
<DL>
<DT><B>Version:</B></DT>
  <DD>1.0</DD>
<DT><B>Author:</B></DT>
  <DD>louis@psybergate.com</DD>
</DL>
<HR>

<P>

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.util.Set</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/sakaiproject/sms/api/SmsCore.html#generateSmsMessages(org.sakaiproject.sms.hibernate.model.SmsTask, java.util.Set)">generateSmsMessages</A></B>(org.sakaiproject.sms.hibernate.model.SmsTask&nbsp;smsTask,
                    java.util.Set&lt;java.lang.String&gt;&nbsp;sakaiUserIDs)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the group list from Sakai and remove users with invalid/empty mobile
 numbers or opted out profiles.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;org.sakaiproject.sms.hibernate.model.SmsTask</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/sakaiproject/sms/api/SmsCore.html#getNextSmsTask()">getNextSmsTask</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Find the next sms task to process from the task queue.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/sakaiproject/sms/api/SmsCore.html#getSakaiMobileNumber(java.lang.String)">getSakaiMobileNumber</A></B>(java.lang.String&nbsp;sakaiUserID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get Sakai user's mobile number from profile.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;org.sakaiproject.sms.hibernate.model.SmsTask</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/sakaiproject/sms/api/SmsCore.html#insertNewTask(java.util.Set, java.util.Date, java.lang.String, java.lang.String)">insertNewTask</A></B>(java.util.Set&lt;java.lang.String&gt;&nbsp;sakaiUserIds,
              java.util.Date&nbsp;dateToSend,
              java.lang.String&nbsp;messageBody,
              java.lang.String&nbsp;sakaiToolId)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add a new task to the sms task list, for eg.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;org.sakaiproject.sms.hibernate.model.SmsTask</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/sakaiproject/sms/api/SmsCore.html#insertNewTask(java.lang.String, java.util.Date, java.lang.String, java.lang.String)">insertNewTask</A></B>(java.lang.String&nbsp;deliverGroupId,
              java.util.Date&nbsp;dateToSend,
              java.lang.String&nbsp;messageBody,
              java.lang.String&nbsp;sakaiToolId)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add a new task to the sms task list, for eg.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/sakaiproject/sms/api/SmsCore.html#processIncomingMessage(org.sakaiproject.sms.hibernate.model.SmsMessage)">processIncomingMessage</A></B>(org.sakaiproject.sms.hibernate.model.SmsMessage&nbsp;smsMessage)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Try to process an incoming message in real-time by inserting it into the
 queue and calling processMessage immediately.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/sakaiproject/sms/api/SmsCore.html#processNextTask()">processNextTask</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the next task to process.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/sakaiproject/sms/api/SmsCore.html#processTask(org.sakaiproject.sms.hibernate.model.SmsTask)">processTask</A></B>(org.sakaiproject.sms.hibernate.model.SmsTask&nbsp;smsTask)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the list of users that must receive the message.</TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="generateSmsMessages(org.sakaiproject.sms.hibernate.model.SmsTask, java.util.Set)"><!-- --></A><H3>
generateSmsMessages</H3>
<PRE>
java.util.Set <B>generateSmsMessages</B>(org.sakaiproject.sms.hibernate.model.SmsTask&nbsp;smsTask,
                                  java.util.Set&lt;java.lang.String&gt;&nbsp;sakaiUserIDs)</PRE>
<DL>
<DD>Get the group list from Sakai and remove users with invalid/empty mobile
 numbers or opted out profiles.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>sakaiSiteID</CODE> - (e.g. !admin)<DD><CODE>sakaiGroupID</CODE> - (the Sakai group UID)<DD><CODE>smsTask</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="getNextSmsTask()"><!-- --></A><H3>
getNextSmsTask</H3>
<PRE>
org.sakaiproject.sms.hibernate.model.SmsTask <B>getNextSmsTask</B>()</PRE>
<DL>
<DD>Find the next sms task to process from the task queue. Determine tasks
 with highest priority. Priority is based on message age and type.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getSakaiMobileNumber(java.lang.String)"><!-- --></A><H3>
getSakaiMobileNumber</H3>
<PRE>
java.lang.String <B>getSakaiMobileNumber</B>(java.lang.String&nbsp;sakaiUserID)</PRE>
<DL>
<DD>Get Sakai user's mobile number from profile. Return the mobile number,
 null if not found.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>sakaiUserID</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="insertNewTask(java.lang.String, java.util.Date, java.lang.String, java.lang.String)"><!-- --></A><H3>
insertNewTask</H3>
<PRE>
org.sakaiproject.sms.hibernate.model.SmsTask <B>insertNewTask</B>(java.lang.String&nbsp;deliverGroupId,
                                                           java.util.Date&nbsp;dateToSend,
                                                           java.lang.String&nbsp;messageBody,
                                                           java.lang.String&nbsp;sakaiToolId)</PRE>
<DL>
<DD>Add a new task to the sms task list, for eg. send message to all
 administrators at 10:00, or get latest announcements and send to mobile
 numbers of Sakai group x (phase II).
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>deliverGroupId</CODE> - <DD><CODE>dateToSend</CODE> - <DD><CODE>messageBody</CODE> - <DD><CODE>sakaiToolId</CODE> - 
<DT><B>Returns:</B><DD></DL>
</DD>
</DL>
<HR>

<A NAME="insertNewTask(java.util.Set, java.util.Date, java.lang.String, java.lang.String)"><!-- --></A><H3>
insertNewTask</H3>
<PRE>
org.sakaiproject.sms.hibernate.model.SmsTask <B>insertNewTask</B>(java.util.Set&lt;java.lang.String&gt;&nbsp;sakaiUserIds,
                                                           java.util.Date&nbsp;dateToSend,
                                                           java.lang.String&nbsp;messageBody,
                                                           java.lang.String&nbsp;sakaiToolId)</PRE>
<DL>
<DD>Add a new task to the sms task list, for eg. send message to all
 administrators at 10:00, or get latest announcements and send to mobile
 numbers of Sakai group x (phase II).
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>sakaiUserIds</CODE> - <DD><CODE>dateToSend</CODE> - <DD><CODE>messageBody</CODE> - <DD><CODE>sakaiToolId</CODE> - 
<DT><B>Returns:</B><DD></DL>
</DD>
</DL>
<HR>

<A NAME="processIncomingMessage(org.sakaiproject.sms.hibernate.model.SmsMessage)"><!-- --></A><H3>
processIncomingMessage</H3>
<PRE>
void <B>processIncomingMessage</B>(org.sakaiproject.sms.hibernate.model.SmsMessage&nbsp;smsMessage)</PRE>
<DL>
<DD>Try to process an incoming message in real-time by inserting it into the
 queue and calling processMessage immediately. If unable to process, then
 leave in the queue for the job scheduler to handle. Incoming messages are
 for later development.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>messageID</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="processNextTask()"><!-- --></A><H3>
processNextTask</H3>
<PRE>
void <B>processNextTask</B>()</PRE>
<DL>
<DD>Gets the next task to process. Based on specific criteria like status en
 date to sent.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="processTask(org.sakaiproject.sms.hibernate.model.SmsTask)"><!-- --></A><H3>
processTask</H3>
<PRE>
void <B>processTask</B>(org.sakaiproject.sms.hibernate.model.SmsTask&nbsp;smsTask)</PRE>
<DL>
<DD>Get the list of users that must receive the message. Send messages to
 SMPP service and also add them to SMS_MESSAGE table as pending. (Statuses
 will be updated when the gateway delivery notifications comes in)
<P>
<DD><DL>
</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/SmsCore.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../org/sakaiproject/sms/api/SmsBilling.html" title="interface in org.sakaiproject.sms.api"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../org/sakaiproject/sms/api/SmsScheduler.html" title="interface in org.sakaiproject.sms.api"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?org/sakaiproject/sms/api/SmsCore.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SmsCore.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
